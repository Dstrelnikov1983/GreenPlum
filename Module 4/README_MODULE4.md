# –ú–æ–¥—É–ª—å 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GreenPlum - ETL/ELT –ø—Ä–æ—Ü–µ—Å—Å—ã

## üì¶ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞

–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è **–ú–æ–¥—É–ª—è 4** –∫—É—Ä—Å–∞ "GreenPlum –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö" —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ ETL-–ø—Ä–æ—Ü–µ—Å—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- ‚úÖ **Yandex Object Storage** (S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- ‚úÖ **Managed Service for Apache Airflow‚Ñ¢** (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)
- ‚úÖ **Yandex MPP Analytics for PostgreSQL** (GreenPlum)

---

## üìÑ –§–∞–π–ª—ã –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ

### 1. üî¨ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4
**–§–∞–π–ª:** `lab4_etl_airflow_s3.md`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é production-ready ETL –ø—Ä–æ—Ü–µ—Å—Å–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:**
- **–ß–∞—Å—Ç—å 1:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Object Storage, Airflow, —Å–µ—Ç–µ–≤–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å)
- **–ß–∞—Å—Ç—å 2:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ß–∞—Å—Ç—å 3:** –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ GreenPlum (staging, dimensions, facts)
- **–ß–∞—Å—Ç—å 4:** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ DAG –≤ Apache Airflow
- **–ß–∞—Å—Ç—å 5:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è ETL –ø—Ä–æ—Ü–µ—Å—Å–∞
- **–ß–∞—Å—Ç—å 6:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- **–ß–∞—Å—Ç—å 7:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ best practices

**–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 90-120 –º–∏–Ω—É—Ç

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ–º—ã:**
- üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Security Groups, IAM)
- üåê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- üìä SCD Type 2 –¥–ª—è dimension —Ç–∞–±–ª–∏—Ü
- üîÑ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- üìà –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ fact —Ç–∞–±–ª–∏—Ü
- ‚úÖ Data Quality –ø—Ä–æ–≤–µ—Ä–∫–∏
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ETL

---

### 2. üêç –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `generate_sample_data.py`

**–û–ø–∏—Å–∞–Ω–∏–µ:** Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:**
- `customers.csv` - 5,000 –∫–ª–∏–µ–Ω—Ç–æ–≤
- `products.csv` - 500 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- `orders.json` - 20,000 –∑–∞–∫–∞–∑–æ–≤ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π
- `orders_incremental.json` - 1,000 –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install faker
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python3 generate_sample_data.py
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–º–µ–Ω–∞, –∞–¥—Ä–µ—Å–∞)
- –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è nested –¥–∞–Ω–Ω—ã—Ö
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –∑–∞ –≥–æ–¥

---

### 3. üóÑÔ∏è SQL —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
**–§–∞–π–ª:** `init_etl_schema.sql`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª–Ω—ã–π SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ë–î

**–°–æ–∑–¥–∞–µ—Ç:**

**–°—Ö–µ–º—ã:**
- `staging` - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π –¥–ª—è —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `dwh` - Data Warehouse (—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
- `etl_metadata` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏ ETL

**Staging —Ç–∞–±–ª–∏—Ü—ã:**
- `staging.customers_stg`
- `staging.products_stg`
- `staging.orders_stg`

**Dimension —Ç–∞–±–ª–∏—Ü—ã (SCD Type 2):**
- `dwh.dim_customers` - –∫–ª–∏–µ–Ω—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π
- `dwh.dim_products` - –ø—Ä–æ–¥—É–∫—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Ü–µ–Ω
- `dwh.dim_date` - –∫–∞–ª–µ–Ω–¥–∞—Ä—å (2020-2026)

**Fact —Ç–∞–±–ª–∏—Ü—ã:**
- `dwh.fact_orders` - –∑–∞–∫–∞–∑—ã (–ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –¥–∞—Ç–µ)
- `dwh.fact_order_items` - –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤

**ETL —Ñ—É–Ω–∫—Ü–∏–∏:**
- `etl_metadata.log_start()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
- `etl_metadata.log_end()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- `etl_metadata.maintain_tables()` - –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

**–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ views:**
- `dwh.daily_sales_report` - –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `dwh.customer_analytics` - –º–µ—Ç—Ä–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- `dwh.top_products` - —Ä–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- `etl_metadata.slow_queries` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
psql "host=$MASTER_FQDN port=6432 sslmode=require dbname=postgres user=admin" \
  -f init_etl_schema.sql
```

---

## üéØ –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è –ú–æ–¥—É–ª—è 4

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ã —Å–º–æ–≥—É—Ç:

‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ—Ö—Å–ª–æ–π–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É ETL (Source ‚Üí Staging ‚Üí DWH)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ Yandex Cloud
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å Security Groups –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

‚úÖ **Object Storage:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –±–∞–∫–µ—Ç–∞–º–∏ S3
- –†–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (CSV, JSON, Parquet)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ IAM –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏

‚úÖ **Apache Airflow:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å DAG'–∏ –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ ETL –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å connections –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL –∏ S3
- –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å error handling –∏ retry –ª–æ–≥–∏–∫—É

‚úÖ **Data Modeling:**
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å Slowly Changing Dimensions (SCD Type 2)
- –°–æ–∑–¥–∞–≤–∞—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ fact —Ç–∞–±–ª–∏—Ü—ã
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—ã–±–∏—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ MPP

‚úÖ **ETL Best Practices:**
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å ETL –ø—Ä–æ—Ü–µ—Å—Å—ã
- –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å data quality –ø—Ä–æ–≤–µ—Ä–∫–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –î–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–∑–∞ –¥–µ–Ω—å –¥–æ –∑–∞–Ω—è—Ç–∏—è):**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Yandex Cloud
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
```

**2. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è (–≤ –Ω–∞—á–∞–ª–µ –∑–∞–Ω—è—Ç–∏—è):**
- –ü–æ–∫–∞–∂–∏—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Å–ª–∞–π–¥–∞—Ö
- –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, S3 bucket)
- –û–±—ä—è—Å–Ω–∏—Ç–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é SCD Type 2 –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ

**3. –ü—Ä–∞–∫—Ç–∏–∫–∞ (–æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å):**
- –†–∞–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `lab4_etl_airflow_s3.md`
- –°—Ç—É–¥–µ–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–æ—à–∞–≥–æ–≤–æ
- –ü–æ–º–æ–≥–∞–π—Ç–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Å–µ—Ç–µ–≤–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ (—ç—Ç–æ —Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

**4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
```sql
-- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
SELECT * FROM etl_metadata.load_log ORDER BY load_start_time DESC LIMIT 10;
SELECT * FROM dwh.daily_sales_report ORDER BY date_actual DESC LIMIT 7;
```

**5. –û–±—Å—É–∂–¥–µ–Ω–∏–µ (–≤ –∫–æ–Ω—Ü–µ):**
- –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤–æ–∑–Ω–∏–∫–ª–∏?
- –ö–∞–∫ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å?
- –û–±—Å—É–¥–∏—Ç–µ production deployment

---

### –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞:

**–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
pip install awscli faker
yc --version  # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Yandex Cloud CLI
```

**–®–∞–≥ 2: –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**
- –û—Ç–∫—Ä–æ–π—Ç–µ `lab4_etl_airflow_s3.md`
- –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ, –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –î–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤–∞–∂–Ω—ã—Ö —à–∞–≥–æ–≤

**–®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```bash
python3 generate_sample_data.py
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ ./sample_data/
```

**–®–∞–≥ 4: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î**
```bash
psql "host=$MASTER_FQDN ..." -f init_etl_schema.sql
```

**–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DAG –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –≤ Airflow
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ GreenPlum
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã

---

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

**Yandex Cloud:**
- –ê–∫—Ç–∏–≤–Ω—ã–π billing account
- –ö–≤–æ—Ç—ã: 3 –∫–ª–∞—Å—Ç–µ—Ä–∞ (GreenPlum + Airflow)
- –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: 500-1000‚ÇΩ/–¥–µ–Ω—å

**–õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞:**
- Python 3.8+
- PostgreSQL –∫–ª–∏–µ–Ω—Ç (psql)
- AWS CLI
- Yandex Cloud CLI
- 2 GB —Å–≤–æ–±–æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏

**–ù–∞–≤—ã–∫–∏:**
- –ë–∞–∑–æ–≤—ã–π Python
- SQL (—Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å)
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π ETL
- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:

**GreenPlum (Yandex MPP Analytics):**
```yaml
Master: s2.medium (4 vCPU, 16 GB RAM)
Segments: 2 √ó s2.medium
Storage: 50 GB network SSD per host
```

**Apache Airflow:**
```yaml
Webserver: s2.micro (2 vCPU, 8 GB RAM)
Scheduler: s2.micro
Workers: 1-3 √ó s2.small (auto-scaling)
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Yandex Cloud                            ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                ‚îÇ
‚îÇ  ‚îÇ   Source     ‚îÇ         ‚îÇ              ‚îÇ                ‚îÇ
‚îÇ  ‚îÇ   Systems    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Object       ‚îÇ                ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ         ‚îÇ Storage (S3) ‚îÇ                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ
‚îÇ                                   ‚îÇ                         ‚îÇ
‚îÇ                                   ‚ñº                         ‚îÇ
‚îÇ                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ                          ‚îÇ   Apache     ‚îÇ                  ‚îÇ
‚îÇ                          ‚îÇ   Airflow    ‚îÇ                  ‚îÇ
‚îÇ                          ‚îÇ  (Orchestrator)                 ‚îÇ
‚îÇ                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îÇ                                 ‚îÇ                           ‚îÇ
‚îÇ                                 ‚ñº                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
‚îÇ  ‚îÇ         GreenPlum MPP Analytics                ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ                                                 ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Staging  ‚îÇ‚îÄ‚ñ∂‚îÇ  DWH     ‚îÇ‚îÄ‚ñ∂‚îÇAnalytics ‚îÇ    ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Layer   ‚îÇ  ‚îÇ  Layer   ‚îÇ  ‚îÇ  Views   ‚îÇ    ‚îÇ       ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ             VPC Network Security                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Security Groups                                   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - IAM Roles                                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Encrypted connections (SSL/TLS)                  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Security Groups:

**Airflow Security Group:**
- Ingress: HTTPS (443), HTTP (80) –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- Egress: PostgreSQL (6432) –∫ GreenPlum
- Egress: HTTPS (443) –∫ Object Storage

**GreenPlum Security Group:**
- Ingress: PostgreSQL (6432) —Ç–æ–ª—å–∫–æ –æ—Ç Airflow subnet
- Egress: –û–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### IAM Roles:

**–î–ª—è Object Storage:**
- `storage.editor` - —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –≤ –±–∞–∫–µ—Ç—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞

**–î–ª—è Airflow:**
- `managed-airflow.integrationProvider`
- `storage.viewer`

---

## üìä Data Flow

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ ETL –ø—Ä–æ—Ü–µ—Å—Å–µ:

```
1. EXTRACT (–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ)
   ‚îî‚îÄ S3 Bucket
      ‚îú‚îÄ customers.csv
      ‚îú‚îÄ products.csv
      ‚îî‚îÄ orders.json

2. TRANSFORM (–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è)
   ‚îî‚îÄ Staging Layer (GreenPlum)
      ‚îú‚îÄ staging.customers_stg
      ‚îú‚îÄ staging.products_stg
      ‚îî‚îÄ staging.orders_stg

3. LOAD (–ó–∞–≥—Ä—É–∑–∫–∞)
   ‚îî‚îÄ DWH Layer (GreenPlum)
      ‚îú‚îÄ Dimensions (SCD Type 2)
      ‚îÇ  ‚îú‚îÄ dwh.dim_customers
      ‚îÇ  ‚îú‚îÄ dwh.dim_products
      ‚îÇ  ‚îî‚îÄ dwh.dim_date
      ‚îÇ
      ‚îî‚îÄ Facts (Partitioned)
         ‚îú‚îÄ dwh.fact_orders
         ‚îî‚îÄ dwh.fact_order_items

4. ANALYTICS (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞)
   ‚îî‚îÄ Views
      ‚îú‚îÄ daily_sales_report
      ‚îú‚îÄ customer_analytics
      ‚îî‚îÄ top_products
```

---

## üéì –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (4 –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–∞):

| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-------|----------|
| –¢–µ–æ—Ä–∏—è ETL/ELT | 20 –º–∏–Ω | –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø–∞—Ç—Ç–µ—Ä–Ω—ã, best practices |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è | 15 –º–∏–Ω | –û–±–∑–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Å–µ—Ç–µ–≤–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã | 30 –º–∏–Ω | S3, Airflow, Security Groups |
| –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î | 20 –º–∏–Ω | Staging, Dimensions, Facts |
| –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ DAG | 40 –º–∏–Ω | Python –∫–æ–¥, –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã Airflow |
| –ü–µ—Ä–µ—Ä—ã–≤ | 10 –º–∏–Ω | - |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ETL | 30 –º–∏–Ω | –ó–∞–ø—É—Å–∫, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ—Ç–ª–∞–¥–∫–∞ |
| –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ | 15 –º–∏–Ω | –û–±–Ω–æ–≤–ª–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | 20 –º–∏–Ω | –ò–Ω–¥–µ–∫—Å—ã, –ø–∞—Ä—Ç–∏—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ |
| –û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | 10 –º–∏–Ω | Q&A, –≤—ã–≤–æ–¥—ã |

---

### –°–æ–≤–µ—Ç—ã –ø–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—é:

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
- –ó–∞—Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–π—Ç–µ demo-–æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- –ò–º–µ–π—Ç–µ backup –ø–ª–∞–Ω –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å cloud

**2. –í–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏—è:**
- –ù–∞—á–Ω–∏—Ç–µ —Å –∂–∏–≤–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –†–∞–∑–±–µ–π—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–∞—Ä—ã –¥–ª—è troubleshooting
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ checkpoints –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø—ã
- –ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è FAQ

**3. Troubleshooting:**
- –î–µ—Ä–∂–∏—Ç–µ –ø–æ–¥ —Ä—É–∫–æ–π —Å–ø–∏—Å–æ–∫ —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ screen sharing –¥–ª—è –ø–æ–º–æ—â–∏
- –ü–æ–æ—â—Ä—è–π—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥—É

**4. –ü–æ—Å–ª–µ –∑–∞–Ω—è—Ç–∏—è:**
- –°–æ–±–µ—Ä–∏—Ç–µ feedback
- –û–±–Ω–æ–≤–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ø—Ä–æ—Å–æ–≤
- –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: DAG –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ Airflow
```bash
# –†–µ—à–µ–Ω–∏–µ:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: python -m py_compile dag_file.py
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º bucket
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ scheduler
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ GreenPlum
```bash
# –†–µ—à–µ–Ω–∏–µ:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ FQDN –º–∞—Å—Ç–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Security Group rules
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ sslmode=require
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Timeout –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ S3
```bash
# –†–µ—à–µ–Ω–∏–µ:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
2. –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ Airflow
3. –†–∞–∑–±–µ–π—Ç–µ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ —á–∞—Å—Ç–∏
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ GreenPlum
```bash
# –†–µ—à–µ–Ω–∏–µ:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ COPY FROM –≤–º–µ—Å—Ç–æ INSERT
2. –û—Ç–∫–ª—é—á–∏—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
3. –£–≤–µ–ª–∏—á—å—Ç–µ batch size
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –≤ Airflow
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [Yandex Object Storage](https://cloud.yandex.ru/docs/storage/)
- [Managed Apache Airflow](https://cloud.yandex.ru/docs/managed-airflow/)
- [Yandex MPP Analytics](https://cloud.yandex.ru/docs/managed-greenplum/)
- [Apache Airflow Docs](https://airflow.apache.org/docs/)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Ç–∞—Ç—å–∏:
- [ETL Best Practices](https://www.stitchdata.com/resources/etl-best-practices/)
- [Slowly Changing Dimensions](https://en.wikipedia.org/wiki/Slowly_changing_dimension)
- [Data Warehouse Design](https://www.kimballgroup.com/)

### –í–∏–¥–µ–æ:
- [Apache Airflow Tutorial](https://www.youtube.com/watch?v=AHMm1wfGuHE)
- [GreenPlum Architecture](https://www.youtube.com/results?search_query=greenplum+architecture)

---

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

### –î–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:
- [ ] –î–æ—Å—Ç—É–ø –∫ Yandex Cloud —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ –∫–≤–æ—Ç–∞–º–∏
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
- [ ] –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ —Ñ–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- [ ] –°–ø–∏—Å–æ–∫ —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫ –∏ —Ä–µ—à–µ–Ω–∏–π
- [ ] Backup –ø–ª–∞–Ω –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –æ–±–ª–∞–∫–æ–º

### –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞:
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Yandex Cloud CLI
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω AWS CLI
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω PostgreSQL client
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.8+
- [ ] –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Yandex Cloud
- [ ] –û–∑–Ω–∞–∫–æ–º–∏–ª—Å—è —Å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ):
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ DAG –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ staging —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ –ï—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ dimension –∏ fact —Ç–∞–±–ª–∏—Ü–∞—Ö

### –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (—Ö–æ—Ä–æ—à–æ):
- ‚úÖ –í—Å–µ –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è
- ‚úÖ SCD Type 2 —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ views

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å (–æ—Ç–ª–∏—á–Ω–æ):
- ‚úÖ –í—Å–µ –∏–∑ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –∏ –ø–∞—Ä—Ç–∏—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏

---

## üí° –ò–¥–µ–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –î–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã:

**1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ REST API
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kafka
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –ë–î

**2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:**
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è data mart –¥–ª—è –æ—Ç–¥–µ–ª–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü
- Machine Learning pipeline

**3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∑–∞–≥—Ä—É–∑–∫–∏
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä—Ç–∏—Ü–∏–π

**4. Monitoring & Alerting:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus
- Dashboard –≤ Grafana
- Email/Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ü–∏—é Troubleshooting –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Airflow –∏ GreenPlum
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ community —Ñ–æ—Ä—É–º—ã

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.  
Copyright ¬© 2025. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.

---

**–ñ–µ–ª–∞–µ–º —É—Å–ø–µ—Ö–æ–≤ –≤ –æ—Å–≤–æ–µ–Ω–∏–∏ ETL –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å GreenPlum!** üöÄ

---

**–í–µ—Ä—Å–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:** 1.0  
**–î–∞—Ç–∞:** –ù–æ—è–±—Ä—å 2025  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- GreenPlum 6.25+
- Apache Airflow 2.5+
- Yandex Cloud (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤)
